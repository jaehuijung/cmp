<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<head>
    <style>
        .dashboard-header {
            background-color: #e0e0e0;
            padding: 20px;
            text-align: center;
            font-size: 24px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .dashboard-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .dashboard-chart {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 100%;
            height: 100%;
            flex: 1 1 200px; /* 기본 너비 300px */
        }
        @media (min-width: 980px) and (max-width: 1800px) {
            .dashboard-chart {
                flex: 1 1 calc(50% - 40px); /* 너비 1/2 */
                max-width: calc(50% - 40px);
            }
        }
        @media (max-width: 970px) {
            .dashboard-chart {
                flex: 1 1 calc(100% - 40px); /* 너비 100% */
                max-width: calc(100% - 40px);
            }
        }
        /* Fixed widths and heights for responsive configuration */
        .size-1-4-500 { width: 500px; height: 500px; }
        .size-1-4-700 { width: 700px; height: 700px; }
        .size-2-2-600 { width: 600px; height: 600px; }
        .size-2-2-700 { width: 700px; height: 700px; }
        .size-2-2-800 { width: 800px; height: 800px; }

        .dashboard-header-item {
            border : 1px solid;
            border-radius: 5px;
            width: calc(100% / 3 - 50px);
            height: 100px;
            margin: 5px 10px;
            padding: 5px;
            display: none; /* 처음엔 모든 아이템을 숨김 */
        }

        .active {
            display: inline-block; /* 활성화된 아이템만 표시 */
        }

        .pagination {
            display: flex;
            justify-content: center;
            text-align: center;
            margin-top: 10px;
        }

        .page-btn {
            cursor: pointer;
            border: 0px;
            background-color: #e0e0e0;
        }
    </style>
</head>

<body>
<div layout:fragment="content">
    <main id="main" class="dashboard">
        <div class="dashboard-header">
            <div class="flex-row-center">
                <div class="dashboard-header-item">1</div>
                <div class="dashboard-header-item">2</div>
                <div class="dashboard-header-item">3</div>
                <div class="dashboard-header-item">4</div>
                <div class="dashboard-header-item">5</div>
                <div class="dashboard-header-item">6</div>
                <div class="dashboard-header-item">7</div>
                <div class="dashboard-header-item">8</div>
                <div class="dashboard-header-item">9</div>
                <div class="dashboard-header-item">10</div>
            </div>

            <div class="pagination">
                <button class="page-btn" onclick="changePage('prev')"><</button>
                <button class="page-btn" onclick="changePage('next')">></button>
            </div>
        </div>

        <div class="dashboard-container">
            <div class="dashboard-chart" id="dashboard-chart1">
                <h4>광 케이블 포설 상세현황</h4>
                <hr>
                <div class="flex-even custom-margin-top-30">
                    <canvas id="fiberCableChart"></canvas>
                </div>
            </div>
            <div class="dashboard-chart" id="dashboard-chart2">
                <h4>UTF 케이블 포설 상세현황</h4>
                <hr>
                <div class="flex-even custom-margin-top-30">
                    <canvas id="utpCableChart"></canvas>
                </div>
            </div>
            <div class="dashboard-chart" id="dashboard-chart3">
                <h4>장비 등록 상세현황</h4>
                <hr>
                <div class="flex-even custom-margin-top-30">
                    <canvas id="equipmentChart"></canvas>
                </div>
            </div>
            <div class="dashboard-chart" id="dashboard-chart4">
                <h4>소프트웨어 등록 상세현황</h4>
                <hr>
                <div class="flex-even custom-margin-top-30">
                    <canvas id="softwareChart"></canvas>
                </div>
            </div>
        </div>
    </main>

    <th:block layout:fragment="script">
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
        <script th:inline="javascript">
            const fiberCableData = /*[[${fiberCableData}]]*/;
            const fiberDetailFilterData = fiberCableData.filter(item => item.speed !== 'total');
            const fiberDetailLabels = fiberDetailFilterData.map(item => item.speed);
            const fiberDetailValues = fiberDetailFilterData.map(item => item.cnt);

            const utpCableData  = /*[[${utpCableData}]]*/;
            const utpDetailFilterData = utpCableData.filter(item => item.speed !== 'total');
            const utpDetailLabels = utpDetailFilterData.map(item => item.speed);
            const utpDetailValues = utpDetailFilterData.map(item => item.cnt);

            const hardwareData  = /*[[${hardwareData}]]*/;
            const hwDetailFilterData = hardwareData.filter(item => item.asset !== 'total');
            const hwDetailLabels = hwDetailFilterData.map(item => item.asset);
            const hwDetailValues = hwDetailFilterData.map(item => item.cnt);

            const softwareData  = /*[[${softwareData}]]*/;
            const swDetailFilterData = softwareData.filter(item => item.asset !== 'total');
            const swDetailLabels = swDetailFilterData.map(item => item.asset);
            const swDetailValues = swDetailFilterData.map(item => item.cnt);
        </script>
        <script>
            const itemsPerPage = 3;
            let currentPage = 0;
            const items = document.querySelectorAll('.dashboard-header-item');

            function showItems(page) {
                items.forEach((item, index) => {
                    item.classList.remove('active');
                    if (index >= page * itemsPerPage && index < (page + 1) * itemsPerPage) {
                        item.classList.add('active');
                    }
                });
            }

            function changePage(direction) {
                if (direction === 'next') {
                    if ((currentPage + 1) * itemsPerPage < items.length) {
                        currentPage++;
                    }
                } else {
                    if (currentPage > 0) {
                        currentPage--;
                    }
                }
                showItems(currentPage);
            }

            // 초기 페이지 표시
            showItems(currentPage);
        </script>
        <script th:src="@{/js/main/dashboard/view.js}"></script>

    </th:block>
</div>
</body>
</html>