<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sl.qr.mh.service.cable.cableMapper">

    <select id="getCableTotalList" parameterType="map" resultType="map">
        /** getCableTotalList ...
            선번장관리 > 선번장목록 > 리스트 목록 */
        select
            cb.cable_manage_id, /* 선번장 관리번호 */
            /* 출발지 */
            seb.asset_id s_asset_id,                                        /* 자산분류 */
            sec.asset_category s_asset_category  ,                          /* 출발지 자산 카테고리 */
            sed.installation_coordinates s_installation_coordinates,        /* 설치좌표 */
            seb.eqp_manage_id s_eqp_manage_id,                              /* 관리 id */
            seb.eqp_name s_eqp_name ,                                       /* 구성자원명 */
            seb.model_name s_model_name,                                    /* 모델명 */
            seb.host_name s_host_name,                                      /* 호스트명 */
            seb.m_company s_m_company,                                      /* 제조사 */
            null s_port,                                                    /* 포트번호 */
            seb.primary_operator s_primary_operator,                        /* 운영담당자 */
            seb.primary_outsourced_operator s_primary_outsourced_operator,  /* 위탁운영담당자 */
            /* 목적지 */
            eeb.asset_id e_asset_id,                                        /* 자산분류 */
            eec.asset_category e_asset_category,                            /* 목적지 자산 카테고리 */
            eed.installation_coordinates e_installation_coordinates,        /* 설치좌표 */
            eeb.eqp_manage_id e_eqp_manage_id,                              /* 관리 id */
            eeb.eqp_name e_eqp_name ,                                       /* 구성자원명 */
            eeb.model_name e_model_name,                                    /* 모델명 */
            eeb.host_name e_host_name,                                      /* 호스트명 */
            eeb.m_company e_m_company,                                      /* 제조사 */
            null e_port,                                                    /* 포트번호 */
            eeb.primary_operator e_primary_operator,                        /* 운영담당자 */
            eeb.primary_outsourced_operator e_primary_outsourced_operator,  /* 위탁운영담당자 */
            /* 선번장 회선 */
            cb.cable_speed ,    /* 회선속도 */
            cb.cable_category , /* 회선구분 */
            cb.cable_color      /* 회선색상 */
        from
            cable_basic cb
        join
            equipment_basic seb
            on cb.start_eqp_id = seb.eqp_manage_id
        join
            equipment_detail sed
            on seb.eqp_manage_id = sed.eqp_manage_id
        join (
                select
                    asset_id , asset_category
                from
                    equipment_categories
                group by
                    asset_id , asset_category
            ) sec
            on seb.asset_id = sec.asset_id
        join
            equipment_basic eeb
            on cb.end_eqp_id = eeb.eqp_manage_id
        join
            equipment_detail eed
            on eeb.eqp_manage_id = eed.eqp_manage_id
        join (
                select
                    asset_id , asset_category
                from
                    equipment_categories
                group by
                    asset_id , asset_category
            ) eec
            on eeb.asset_id = eec.asset_id
        ORDER BY cb.cable_manage_id desc
        LIMIT #{offset},#{limit};
    </select>

    <select id="getCableTotalListCnt" parameterType="map" resultType="int">
        /** getCableTotalListCnt ...
            선번장관리 > 선번장 목록 > 리스트 개수 */
        select
            count(cb.cable_manage_id)
        from
            cable_basic cb
        join
            equipment_basic seb
            on cb.start_eqp_id = seb.eqp_manage_id
        join
            equipment_detail sed
            on seb.eqp_manage_id = sed.eqp_manage_id
        join (
                select
                    asset_id , asset_category
                from
                    equipment_categories
                group by
                    asset_id , asset_category
            ) sec
            on seb.asset_id = sec.asset_id
        join
            equipment_basic eeb
            on cb.end_eqp_id = eeb.eqp_manage_id
        join
            equipment_detail eed
            on eeb.eqp_manage_id = eed.eqp_manage_id
        join (
                select
                    asset_id , asset_category
                from
                    equipment_categories
                group by
                    asset_id , asset_category
            ) eec
            on eeb.asset_id = eec.asset_id
    </select>

    <select id="getRackEquipmentList" parameterType="map" resultType="map">
        /** getCableTotalListCnt ...
            선번장관리 > 선번장목록 > 추가 > 출발지, 목적지 리스트 */
    </select>

    <select id="getRackEquipmentListCnt" parameterType="map" resultType="int">
        /** getRackEquipmentListCnt ...
            선번장관리 > 선번장목록 > 추가 > 출발지, 목적지 리스트 개수 */
    </select>


</mapper>